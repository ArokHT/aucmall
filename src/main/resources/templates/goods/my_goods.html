<!-- Copyright (c) 2019-2020 十三 all rights reserved. -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<!--<header th:replace="admin/header::header-fragment">-->
<head th:replace="mall/header::head-fragment('NewBee商城-个人中心','index')">

</head>
<link rel="stylesheet" th:href="@{'/mall/styles/search.css'}">
<style>
    .ui-jqgrid tr.jqgrow td {
        white-space: normal !important;
        height: auto;
        vertical-align: text-top;
        padding-top: 2px;
    }

    li{
        float: left;
    }
    /*a {
        color: #1baeae;
        text-decoration: none;
        background-color: transparent;
        -webkit-text-decoration-skip: objects;
    }

    a:hover {
        color: white;
        background-color: #1baeae;
    }*/
</style>
<body>
<nav th:replace="mall/header::nav-fragment"></nav>
<header th:replace="mall/header::header-fragment"></header>
<content id="content">

    <div id="recommend" style="height: auto">
        <h2>我的商品</h2>
        <a href="/add_goods" class="more" style="color: #4db8d2; top:12px; font-size: 1.5em; font-weight: bold">上架商品</a>
        <!--<input class="car" type="button" th:onclick="" value="立即选购"/>-->
        <ul style="display: inline;">
            <!-- 已配置新品则显示配置内容 -->
            <th:block th:if="${#lists.isEmpty(mygoods)}">
                <h3>
                    还没有商品哦，快去上架吧！
                </h3>
            </th:block>
            <th:block th:unless="${#lists.isEmpty(mygoods)}">
                <th:block th:each="mygood : ${mygoods}">
                    <li>
                        <a th:href="@{'/goods/detail/'+${mygood.id}}">
                            <img th:src="@{${mygood.img}}" th:alt="${mygood.name}">
                            <p class="name" th:text="${mygood.name}">NewBeeMall</p>
                            <!--<p class="item_price" th:text="${mygood.mark}">NewBeeMall</p>-->
                            <p class="item_price" th:text="${mygood.mark.length()>15}?${mygood.mark.substring(0,15)}+'...' : ${mygood.mark}">NewBeeMall</p>
                            <p class="price" style="color: red" th:text="'￥'+${mygood.reservePrice}">NewBeeMall</p>
                        </a>
                    </li>
                </th:block>
            </th:block>
        </ul>
    </div>
</content>
<div class="goods_item center">
    <div class="pages">
            <div class="page_wrap">
                <th:block th:if="${!#lists.isEmpty(mygoods)}">
                <span class="page_span1">
                    <a th:href="@{${curpage==1}?'##':'/my_goods?page=' + ${curpage-1}}">
                                        < 上一页
                     </a>
                    <th:block th:if="${curpage-2 >= 1}"><a
                            th:href="@{'/my_goods?page=' + ${curpage-2}}"
                            th:text="${curpage -2}">1</a></th:block>
                    <th:block th:if="${curpage-1 >= 1}"><a
                            th:href="@{'/my_goods?page=' + ${curpage-1}}"
                            th:text="${curpage -1}">1</a></th:block>
                    <a href="##" class="active" th:text="${curpage}">1</a>
                    <th:block th:if="${curpage+1<=totalpage}"><a
                            th:href="@{'/my_goods?page=' + ${curpage+1}}"
                            th:text="${curpage +1}">1</a></th:block>
                    <th:block th:if="${curpage+2<=totalpage}"><a
                            th:href="@{'/my_goods?page=' + ${curpage+2}}"
                            th:text="${curpage +2}">1</a></th:block>
                    <a th:href="@{${curpage>=totalpage}?'##':'/my_goods?page=' + ${curpage+1}}">
                                        下一页 >
                     </a>


                    <!--<a th:href="@{${pageResult.currPage==1}?'##':'/search?keyword='+${keyword==null?'':keyword}+'&page=' + ${pageResult.currPage-1}+'&goodsCategoryId='+${goodsCategoryId==null?'':goodsCategoryId}+'&orderBy='+${orderBy==null?'':orderBy}}">
                                       < 上一页
                    </a>
                   <th:block th:if="${pageResult.currPage-2 >=1}"><a
                           th:href="@{'/search?keyword='+${keyword==null?'':keyword}+'&page=' + ${pageResult.currPage-2}+'&goodsCategoryId='+${goodsCategoryId==null?'':goodsCategoryId}+'&orderBy='+${orderBy==null?'':orderBy}}"
                           th:text="${pageResult.currPage -2}">1</a></th:block>
                   <th:block th:if="${pageResult.currPage-1 >=1}"><a
                           th:href="@{'/search?keyword='+${keyword==null?'':keyword}+'&page=' + ${pageResult.currPage-1}+'&goodsCategoryId='+${goodsCategoryId==null?'':goodsCategoryId}+'&orderBy='+${orderBy==null?'':orderBy}}"
                           th:text="${pageResult.currPage -1}">1</a></th:block>
                   <a href="##" class="active" th:text="${pageResult.currPage}">1</a>
                   <th:block th:if="${pageResult.currPage+1<=pageResult.totalPage}"><a
                           th:href="@{'/search?keyword='+${keyword==null?'':keyword}+'&page=' + ${pageResult.currPage+1}+'&goodsCategoryId='+${goodsCategoryId==null?'':goodsCategoryId}+'&orderBy='+${orderBy==null?'':orderBy}}"
                           th:text="${pageResult.currPage +1}">1</a></th:block>
                   <th:block th:if="${pageResult.currPage+2<=pageResult.totalPage}"><a
                           th:href="@{'/search?keyword='+${keyword==null?'':keyword}+'&page=' + ${pageResult.currPage+2}+'&goodsCategoryId='+${goodsCategoryId==null?'':goodsCategoryId}+'&orderBy='+${orderBy==null?'':orderBy}}"
                           th:text="${pageResult.currPage +2}">1</a></th:block>
                    <a th:href="@{${pageResult.currPage>=pageResult.totalPage}?'##':'/search?keyword='+${keyword==null?'':keyword}+'&page=' + ${pageResult.currPage+1}+'&goodsCategoryId='+${goodsCategoryId==null?'':goodsCategoryId}+'&orderBy='+${orderBy==null?'':orderBy}}">
                                       下一页 >
                    </a>-->
                </span>
                </th:block>
            </div>
    </div>
    </div>

<!-- jQuery -->
<script th:src="@{/admin/plugins/jquery/jquery.min.js}"></script>
<!-- Bootstrap 4 -->
<!--<script th:src="@{/admin/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
&lt;!&ndash; AdminLTE App &ndash;&gt;
<script th:src="@{/admin/dist/js/adminlte.min.js}"></script>-->
<!-- jqgrid -->
<!--<script th:src="@{/admin/plugins/jqgrid-5.5.2/jquery.jqGrid.min.js}"></script>
<script th:src="@{/admin/plugins/jqgrid-5.5.2/grid.locale-cn.js}"></script>
&lt;!&ndash; sweetalert &ndash;&gt;
<script th:src="@{/admin/plugins/sweetalert/sweetalert.min.js}"></script>
<script th:src="@{/admin/dist/js/public.js}"></script>
<script th:src="@{/admin/dist/js/newbee_mall_goods.js}"></script>-->
<script th:src="@{/admin/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/mall/js/swiper-bundle.min.js}" type="text/javascript"></script>
<script th:src="@{/admin/plugins/sweetalert/sweetalert.min.js}"></script>
<script th:src="@{/mall/js/index.js}" type="text/javascript"></script>
<script th:src="@{/mall/js/search.js}" type="text/javascript"></script>

<script th:src="@{/admin/plugins/jquery/jquery.min.js}"></script>
<script th:src="@{/mall/js/search.js}" type="text/javascript"></script>
<script>
    /*layui.use('laypage', function(){
        var laypage = layui.laypage;

        //执行一个laypage实例
        laypage.render({
            elem: 'test1' //注意，这里的 test1 是 ID，不用加 # 号
            ,count: 50 //数据总数，从服务端得到
        });
    });
    layui.use(['jquery', 'layer','laypage'], function () {
        var $ = layui.jquery,
            layer = layui.layer,
            laypage = layui.laypage;
        var page = 1;//当前页
        var limit = 8;//每页显示的数目
        var allCount,resCount, resData;

        //同步加载商品数据
        function renderProduct(page, limit){
            var info={
                /!*page: page,
                limit: limit,
                userid:localuserinfo.id*!/
            }
            $.ajax({
                url: '/getuserallmerch.do',
                data: JSON.stringify(info),
                dataType: 'json',
                contentType:'application/json;charset=UTF-8', //contentType很重要
                type : "POST",
                success: function(result){
                    allCount = result.allcount;
                    resCount=result.count;
                    resData = result.data;
                    //renderProductHtml(resData);
                    render();
                }
            });
        }

        //分页的完整功能
        function renderPage1(){
            renderProduct(page, limit);
        }

        function render() {
            laypage.render({
                elem: 'layuipage'
                ,count: allCount
                ,limit: limit
                ,limits: [limit]
                ,curr: page
                ,theme: '#FFB800'
                ,layout: ['count','prev', 'page', 'next', 'limit', 'refresh', 'skip']
                ,jump: function(obj, first){
                    console.info(obj.curr);
                    console.info(obj.limit);
                    page = obj.curr;
                    limit = obj.limit;
                    if(!first){
                        renderProduct(page, limit);
                    }
                }
            });
        }
        //渲染展示商品的html页面
        /!*function renderProductHtml(data){
            var str = "";//用来存储html内容
            if(data.length > 0){
                $.each(data, function(v, o){
                    /!*str += "<div style='margin:auto; margin-bottom:130px;  width:600px; height:350px; float:left; text-align:center'><div><img alt='' src='"+o.img+"' width='330px' height='330px'/></div>";
                    str += "<div style='text-align:center'><div><label>商品名称:</label><span>"+o.name+"</span></div>";
                    str += "<div style='text-align:center'><div><label>商品注释:</label><span>"+o.mark+"</span></div>";
                    str += "<div><label>起拍价/心理价:</label><span style='color:#FF3030;'>￥"+o.reservePrice+"</span></div>";
                    str += "<label>状态:</label><span style='color:#CDC9C9;'>"+o.status+"</span></div>";
                    str += "<div style='display:none;'><label>商品ID:</label><span>"+o.id+"</span></div></div></div>";*!/
                    str += "<div class='item' style='width:400px;height:500px'> <div class='img'> <a href='javascript:void(0);' onclick='clickmerch("+o.id+")'><img src='"+o.img+"' width='400px' height='400px'></a> </div>";
                    str += "<div class='text'> <a href='javascript:void(0);' onclick='clickmerch("+o.id+")'><p class='title' >"+o.name+"</p></a>";
                    str += "<p class='price'><span class='pri'>￥"+o.reservePrice+"</span>";
                    str += "<span class='nub'>"+o.status+"</span></p></div></div>";
                });
                $("#product").html(str);
            }
        }*!/
    });*/
</script>
</body>
</html>
